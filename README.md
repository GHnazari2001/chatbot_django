# پروژه چت‌بات هوشمند با معماری RAG

این پروژه یک وب اپلیکیشن چت‌بات است که با استفاده از فریمورک جنگو در بک‌اند و معماری پیشرفته RAG برای پاسخ‌دهی هوشمند پیاده‌سازی شده است.

---

### **لینک‌های دسترسی**

* **لینک اجرای زنده پروژه:** `http://ghadirr.pythonanywhere.com`


---

### **قابلیت‌های کلیدی**

* **حالت مهمان:** امکان چت موقت بدون نیاز به ثبت نام.
* **سیستم کاربران:** ثبت نام، ورود و خروج امن کاربران.
* **مدیریت گفتگوها:** ایجاد، حذف و تغییر نام گفتگوهای ذخیره شده.
* **پاسخ‌دهی هوشمند:** استفاده از سرویس‌های Vectara, Cohere و Azure AI برای پاسخ به سوالات بر اساس دانش موجود.
* **گفتار به متن:** قابلیت استفاده از میکروفن برای ارسال پیام.
* **طراحی ریسپانسیو:** ظاهر بهینه برای نمایش در دسکتاپ و موبایل.

---

### **تکنولوژی‌های استفاده شده**

* **Backend:** Python, Django
* **Frontend:** HTML, CSS, JavaScript
* **AI Services:** Vectara, Azure AI
* **Database:** mysql
* **Deployment:** PythonAnywhere, Git, GitHub

# پلتفرم چت هوشمند مبتنی بر RAG

[cite_start]این پروژه یک پلتفرم چت هوشمند و مدرن است که با استفاده از معماری RAG (Retrieval-Augmented Generation)، پاسخ‌های دقیق و مستند را بر اساس یک پایگاه دانش مشخص ارائه می‌دهد[cite: 1]. [cite_start]هدف اصلی، کاهش خطای توهم (Hallucination) و افزایش اعتمادپذیری پاسخ‌ها در مقایسه با چت‌بات‌های عمومی است[cite: 1].

## ✨ ویژگی‌های کلیدی

* [cite_start]**معماری RAG**: پاسخ‌ها به صورت مستقیم از اسناد معتبر در پایگاه دانش استخراج و تولید می‌شوند [cite: 2] [cite_start]که دقت و اطمینان را به شدت بالا می‌برد[cite: 20].
* [cite_start]**سیستم چت دو حالته**: ارائه سرویس به دو صورت **کاربر مهمان** (بدون ذخیره‌سازی تاریخچه [cite: 11][cite_start]) و **کاربر عضو** (با قابلیت ذخیره و مدیریت گفتگوها [cite: 2]).
* [cite_start]**تجربه کاربری مدرن (SPA-like)**: رابط کاربری تک‌صفحه‌ای و روان که بدون نیاز به بارگذاری مجدد صفحه، تجربه‌ای سریع و لذت‌بخش را فراهم می‌کند[cite: 3, 26].
* **مدیریت هوشمند گفتگو**:
    * [cite_start]**تولید خودکار عنوان**: ایجاد عنوان‌های هوشمند و کوتاه برای هر چت جدید بر اساس اولین پیام کاربر[cite: 3, 10, 15].
    * [cite_start]**مدیریت کامل چت**: قابلیت تغییر نام و حذف گفتگوها توسط کاربر[cite: 3, 11].
* [cite_start]**قابلیت گفتار به متن (Speech-to-Text)**: پیاده‌سازی شده با `Web Speech API` [cite: 4] [cite_start]به صورت کامل در سمت کاربر برای تجربه‌ای سریع و بدون بار اضافی روی سرور[cite: 28].

## 🛠️ تکنولوژی‌های استفاده شده

[cite_start]این پروژه بر اساس یک معماری چندلایه [cite: 3] و با استفاده از تکنولوژی‌های زیر ساخته شده است:

| بخش | تکنولوژی / سرویس | کاربرد در پروژه |
| --- | --- | --- |
| **بک‌اند (Backend)** | **Django (Python)** | [cite_start]فریمورک اصلی برای ساخت منطق سرور، مدیریت پایگاه داده و احراز هویت[cite: 4]. |
| | **SQLite** | [cite_start]پایگاه داده پیش‌فرض برای توسعه و نمونه‌سازی سریع[cite: 4]. |
| **هوش مصنوعی (AI)** | **Vectara** | [cite_start]به عنوان پایگاه داده وکتور برای جستجو و بازیابی اسناد مرتبط (مرحله Retrieval)[cite: 4]. |
| | **Azure AI (GPT-4.1)** | [cite_start]به عنوان مدل زبان بزرگ برای تولید پاسخ نهایی (مرحله Generation) و عناوین چت[cite: 4]. |
| **فرانت‌اند (Frontend)** | **Vanilla JavaScript (ES6+)** | [cite_start]پیاده‌سازی تمام منطق پویای سمت کاربر، مدیریت درخواست‌های AJAX و به‌روزرسانی DOM[cite: 4]. |
| | **HTML5/CSS3 / Bootstrap 5** | [cite_start]برای ساختار، استایل‌دهی و طراحی واکنش‌گرای رابط کاربری[cite: 4]. |
| | **Web Speech API** | [cite_start]برای پیاده‌سازی قابلیت گفتار به متن به صورت مستقیم در مرورگر[cite: 4]. |

## 🏛️ معماری پروژه

معماری پروژه به سه لایه اصلی تقسیم شده است تا وظایف به صورت شفاف و بهینه مدیریت شوند:

### ۱. لایه بک‌اند (Backend)

* [cite_start]**فریمورک**: Django [cite: 4]
* [cite_start]**اپلیکیشن اصلی**: `chat` که تمام منطق اصلی برنامه، از جمله مدل‌های داده (`Chat` و `Message` [cite: 5][cite_start]), ویوها و URL ها را در خود جای داده است[cite: 5].
* **وظایف کلیدی**:
    * [cite_start]احراز هویت کاربران (ثبت‌نام، ورود و خروج)[cite: 7, 8].
    * [cite_start]مدیریت کامل چت‌ها (ایجاد، حذف، تغییر نام)[cite: 7, 8, 11].
    * [cite_start]پردازش و ذخیره‌سازی پیام‌ها در پایگاه داده[cite: 5].
    * [cite_start]ارتباط با سرویس هوش مصنوعی برای دریافت پاسخ‌ها[cite: 10].

### ۲. سرویس هوش مصنوعی (AI Service)

* [cite_start]**ماژول**: `rag_service.py` [cite: 12]
* [cite_start]این ماژول قلب تپنده پروژه است [cite: 18] [cite_start]و تمام منطق پیچیده مربوط به هوش مصنوعی را از سایر بخش‌های برنامه جدا می‌کند[cite: 12]. [cite_start]این سرویس پایپ‌لاین **RAG** را در سه مرحله پیاده‌سازی می‌کند[cite: 18]:
    1.  [cite_start]**جستجو (Retrieval)**: سوال کاربر به **Vectara** ارسال شده و اسناد مرتبط از پایگاه دانش بازیابی می‌شوند تا پاسخ بر اساس اطلاعات معتبر باشد[cite: 19, 20].
    2.  [cite_start]**غنی‌سازی (Augmentation)**: دانش بازیابی شده، تاریخچه گفتگو و سوال جدید کاربر در یک پرامپت جامع ترکیب می‌شوند[cite: 21].
    3.  [cite_start]**تولید (Generation)**: پرامپت نهایی به **Azure AI** ارسال شده تا یک پاسخ دقیق و منسجم تولید شود[cite: 22].

### ۳. لایه فرانت‌اند (Frontend)

* [cite_start]**تکنولوژی اصلی**: Vanilla JavaScript (ES6+) [cite: 4]
* [cite_start]**فایل کلیدی**: `static/chat/js/chat.js` [cite: 24]
* **وظایف کلیدی**:
    * [cite_start]مدیریت تمام ارتباطات با سرور به صورت آسنکرون با استفاده از **Fetch API**[cite: 24].
    * [cite_start]به‌روزرسانی مستقیم DOM برای نمایش پیام‌های جدید بدون رفرش صفحه[cite: 25].
    * [cite_start]استفاده از **History API** برای تغییر URL و ایجاد یک تجربه تک‌صفحه‌ای (SPA)[cite: 26].
    * [cite_start]استفاده از `data attributes` در HTML برای انتقال امن اطلاعاتی مانند شناسه چت و توکن CSRF از بک‌اند به جاوا اسکریپت[cite: 23].

## 🚀 شروع به کار

برای اجرای این پروژه به صورت محلی، مراحل زیر را دنبال کنید.

### پیش‌نیازها

* [cite_start]**Python** (نسخه ۳.۸ به بالا) [cite: 30]
* [cite_start]**Pip** (برای مدیریت پکیج‌ها) [cite: 30]
* [cite_start](توصیه می‌شود) یک **محیط مجازی** (Virtual Environment) برای ایزوله کردن وابستگی‌های پروژه[cite: 30].

### مراحل نصب و راه‌اندازی

۱. **کلون کردن پروژه:**
   ```bash
   git clone [https://github.com/your-username/your-repository-name.git](https://github.com/your-username/your-repository-name.git)
   cd your-repository-name

## 🚀 مراحل ساخت و راه‌اندازی

برای ساخت و اجرای این پروژه از ابتدا، مراحل زیر را به ترتیب دنبال کنید.

### ۱. پیش‌نیازها و ابزارها

قبل از شروع، اطمینان حاصل کنید که ابزارهای زیر را نصب کرده‌اید:
* [cite_start]**Python**: نسخه ۳.۸ به بالا به عنوان زبان اصلی برنامه نویسی[cite: 30].
* [cite_start]**Pip**: برای مدیریت پکیج‌های پایتون[cite: 30].
* [cite_start]**محیط مجازی (Virtual Environment)**: برای ایزوله کردن وابستگی‌های پروژه (بسیار توصیه می‌شود)[cite: 30].

### ۲. نصب و پیکربندی

۱.  **ایجاد پروژه و اپلیکیشن جنگو:**
    ```bash
    django-admin startproject config .
    python manage.py startapp chat
    ```
    * [cite_start]یک پروژه جنگو به نام `config` و یک اپلیکیشن به نام `chat` ایجاد می‌شود[cite: 33].

۲.  **نصب کتابخانه‌های مورد نیاز:**
    ```bash
    pip install Django crispy-forms crispy-bootstrap5 python-dotenv langchain-community vectara-client azure-ai-inference openai-whisper
    ```
    * [cite_start]این دستور تمام کتابخانه‌های لازم برای پروژه را نصب می‌کند[cite: 30].

۳.  **ایجاد فایل متغیرهای محیطی:**
    * [cite_start]یک فایل با نام `.env` در ریشه اصلی پروژه ایجاد کنید[cite: 31].
    * [cite_start]کلیدهای API خود را در این فایل ذخیره کنید[cite: 32]:
    ```env
    # .env file

    # Vectara API Keys
    VECTARA_CUSTOMER_ID="YOUR_VECTARA_CUSTOMER_ID"
    VECTARA_CORPUS_ID="YOUR_VECTARA_CORPUS_ID"
    VECTARA_API_KEY="YOUR_VECTARA_API_KEY"

    # Azure Al API Keys
    AZURE_AI_ENDPOINT="YOUR_AZURE_AI_ENDPOINT"
    AZURE_AI_TOKEN="YOUR_AZURE_AI_TOKEN"
    ```

۴.  **پیکربندی `settings.py`:**
    * [cite_start]اپلیکیشن‌های `chat` و `crispy_forms` را به لیست `INSTALLED_APPS` اضافه کنید[cite: 33].
    * [cite_start]پک‌های قالب `crispy-forms` را تعریف کنید[cite: 33].
    * [cite_start]متغیرهای مربوط به لاگین و ریدایرکت را تنظیم کنید[cite: 34].

۵.  **طراحی و اعمال تغییرات پایگاه داده:**
    * [cite_start]مدل‌های `Chat` و `Message` را در فایل `chat/models.py` تعریف کنید[cite: 5].
    * [cite_start]سپس دستورات زیر را برای اعمال مدل‌ها به پایگاه داده اجرا کنید[cite: 34]:
    ```bash
    python manage.py makemigrations
    python manage.py migrate
    ```

۶.  **ساخت سرویس هوشمند (`rag_service.py`):**
    * [cite_start]فایلی به نام `rag_service.py` در پوشه `chat` ایجاد کنید[cite: 35].
    * [cite_start]در این فایل، توابع `get_rag_response` [cite: 35] [cite_start]و `generate_chat_title` [cite: 36] را برای ارتباط با سرویس‌های هوش مصنوعی پیاده‌سازی کنید.

۷.  **ایجاد قالب‌های HTML:**
    * [cite_start]در پوشه `chat`، یک پوشه جدید به نام `templates` بسازید[cite: 37].
    * [cite_start]فایل‌های `base.html`, `login.html`, `signup.html` و `chat.html` را در آن ایجاد کنید[cite: 38].

۸.  **نوشتن ویوها و URL ها:**
    * [cite_start]فایل `chat/urls.py` را برای تعریف مسیرهای اپلیکیشن ایجاد کنید[cite: 39].
    * [cite_start]تمام منطق پردازش درخواست‌ها، شامل توابع احراز هویت و پیام‌رسانی، را در فایل `chat/views.py` بنویسید[cite: 40].
    * [cite_start]مسیر اصلی پروژه در `config/urls.py` را به اپلیکیشن `chat` متصل کنید[cite: 41].

۹.  **افزودن استایل (CSS) و منطق پویا (JavaScript):**
    * [cite_start]فایل `style.css` را در مسیر `static/chat/css` برای زیباسازی رابط کاربری قرار دهید[cite: 42].
    * [cite_start]فایل `chat.js` را در مسیر `static/chat/js` برای مدیریت تمام تعاملات پویا و ارتباط آسنکرون با سرور قرار دهید[cite: 43].

### ۳. اجرای سرور

* در نهایت، سرور توسعه جنگو را با دستور زیر اجرا کنید:
    ```bash
    python manage.py runserver
    ```
    * [cite_start]اکنون پروژه شما آماده و در حال اجرا است[cite: 44].
